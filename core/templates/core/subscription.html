{% extends 'core/base.html' %}

{% block content %}
<h2 class="mb-4">Mi Suscripción</h2>

<div class="row">
    <div class="col-md-8">
        {% if subscription %}
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">Plan Activo</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h3 class="text-success">{{ subscription.get_plan_name_display }}</h3>
                        <p class="text-muted mb-3">Tu suscripción actual</p>
                        
                        <table class="table table-sm">
                            <tr>
                                <th>Fecha de Inicio:</th>
                                <td>{{ subscription.start_date|date:"d/m/Y" }}</td>
                            </tr>
                            <tr>
                                <th>Fecha de Término:</th>
                                <td>{{ subscription.end_date|date:"d/m/Y" }}</td>
                            </tr>
                            <tr>
                                <th>Estado:</th>
                                <td>
                                    {% if subscription.active %}
                                        <span class="badge bg-success">Activa</span>
                                    {% else %}
                                        <span class="badge bg-danger">Inactiva</span>
                                    {% endif %}
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="col-md-6">
                        <h5>Beneficios del Plan {{ subscription.get_plan_name_display }}</h5>
                        <ul class="list-unstyled">
                            {% if subscription.plan_name == 'basic' %}
                                <li>✓ Hasta 1 sucursal</li>
                                <li>✓ 3 usuarios</li>
                                <li>✓ Reportes básicos</li>
                                <li>✗ Sin soporte prioritario</li>
                            {% elif subscription.plan_name == 'standard' %}
                                <li>✓ Hasta 5 sucursales</li>
                                <li>✓ 10 usuarios</li>
                                <li>✓ Reportes avanzados</li>
                                <li>✓ Soporte email</li>
                            {% elif subscription.plan_name == 'premium' %}
                                <li>✓ Sucursales ilimitadas</li>
                                <li>✓ Usuarios ilimitados</li>
                                <li>✓ Todos los reportes</li>
                                <li>✓ Soporte 24/7</li>
                                <li>✓ API completa</li>
                            {% endif %}
                        </ul>
                    </div>
                </div>
                
                <hr>
                
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        {% now "Y-m-d" as today %}
                        {% if subscription.end_date|date:"Y-m-d" < today %}
                            <span class="badge bg-danger">Suscripción Vencida</span>
                        {% elif subscription.end_date|date:"Y-m-d" <= today|add:"30 days" %}
                            <span class="badge bg-warning text-dark">Próxima a Vencer</span>
                        {% endif %}
                    </div>
                    <div>
                        <button class="btn btn-primary" disabled>Renovar Suscripción</button>
                        <button class="btn btn-outline-secondary" disabled>Cambiar Plan</button>
                    </div>
                </div>
            </div>
        </div>
        {% else %}
        <div class="alert alert-warning">
            <h5>No tienes una suscripción activa</h5>
            <p>Contacta al administrador para activar tu suscripción.</p>
        </div>
        {% endif %}
    </div>

    <div class="col-md-4">
        <div class="card shadow-sm">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">Planes Disponibles</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <h6 class="text-muted">Básico</h6>
                    <p class="mb-1 small">Ideal para pequeños negocios</p>
                    <strong>CLP $29.990/mes</strong>
                </div>
                <hr>
                <div class="mb-3">
                    <h6 class="text-muted">Estándar</h6>
                    <p class="mb-1 small">Para negocios en crecimiento</p>
                    <strong>CLP $59.990/mes</strong>
                </div>
                <hr>
                <div class="mb-3">
                    <h6 class="text-muted">Premium</h6>
                    <p class="mb-1 small">Solución empresarial completa</p>
                    <strong>CLP $99.990/mes</strong>
                </div>
                <hr>
                <button class="btn btn-primary w-100" disabled>Contactar Ventas</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
