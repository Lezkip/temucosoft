<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TemucoSoft - Gestión</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f9fa;
        }
        .navbar-brand {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            font-size: 1.5rem;
        }
        .navbar-custom {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        /* Colores elegantes para las cards */
        .card {
            transition: transform 0.2s, box-shadow 0.2s;
            border: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.12);
        }
        
        /* POS - Azul profundo */
        .border-primary { border-left: 4px solid #4A5568 !important; }
        .bg-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important; }
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; }
        .btn-primary:hover { background: linear-gradient(135deg, #5568d3 0%, #653a8b 100%); }
        
        /* Productos - Verde esmeralda */
        .border-info { border-left: 4px solid #38A169 !important; }
        .bg-info { background: linear-gradient(135deg, #38A169 0%, #2F855A 100%) !important; }
        .btn-info { background: linear-gradient(135deg, #38A169 0%, #2F855A 100%); border: none; color: white; }
        .btn-info:hover { background: linear-gradient(135deg, #2F855A 0%, #276749 100%); }
        
        /* Proveedores/Secondary - Gris sofisticado */
        .border-secondary { border-left: 4px solid #718096 !important; }
        .bg-secondary { background: linear-gradient(135deg, #718096 0%, #4A5568 100%) !important; }
        .btn-secondary { background: linear-gradient(135deg, #718096 0%, #4A5568 100%); border: none; }
        .btn-secondary:hover { background: linear-gradient(135deg, #4A5568 0%, #2D3748 100%); }
        
        /* Carrito/Success - Verde menta */
        .border-success { border-left: 4px solid #48BB78 !important; }
        .bg-success { background: linear-gradient(135deg, #48BB78 0%, #38A169 100%) !important; }
        .btn-success { background: linear-gradient(135deg, #48BB78 0%, #38A169 100%); border: none; }
        .btn-success:hover { background: linear-gradient(135deg, #38A169 0%, #2F855A 100%); }
        
        /* Reportes/Warning - Ámbar */
        .border-warning { border-left: 4px solid #ED8936 !important; }
        .bg-warning { background: linear-gradient(135deg, #F6AD55 0%, #ED8936 100%) !important; }
        .btn-warning { background: linear-gradient(135deg, #F6AD55 0%, #ED8936 100%); border: none; color: white; }
        .btn-warning:hover { background: linear-gradient(135deg, #ED8936 0%, #DD6B20 100%); }
        
        /* Usuarios/Dark - Negro elegante */
        .border-dark { border-left: 4px solid #2D3748 !important; }
        .bg-dark { background: linear-gradient(135deg, #2D3748 0%, #1A202C 100%) !important; }
        .btn-dark { background: linear-gradient(135deg, #2D3748 0%, #1A202C 100%); border: none; }
        .btn-dark:hover { background: linear-gradient(135deg, #1A202C 0%, #000000 100%); }
        
        /* Suscripción/Danger - Rojo coral */
        .border-danger { border-left: 4px solid #F56565 !important; }
        .bg-danger { background: linear-gradient(135deg, #FC8181 0%, #F56565 100%) !important; }
        .btn-danger { background: linear-gradient(135deg, #FC8181 0%, #F56565 100%); border: none; }
        .btn-danger:hover { background: linear-gradient(135deg, #F56565 0%, #E53E3E 100%); }
        
        /* Badges más elegantes */
        .badge { padding: 0.5rem 1rem; font-weight: 500; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom mb-4">
        <div class="container">
            <a class="navbar-brand" href="/">TemucoSoft</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    {% if request.user.is_authenticated %}
                        {# Vendedor: POS, Productos (ver), Carro #}
                        {% if request.user.role == 'vendedor' %}
                            <li class="nav-item"><a class="nav-link" href="{% url 'pos' %}">POS</a></li>
                            <li class="nav-item"><a class="nav-link" href="{% url 'product_list' %}">Productos</a></li>
                            <li class="nav-item"><a class="nav-link" href="{% url 'cart' %}">Carro</a></li>
                        {% endif %}

                        {# Gerente: Productos, Proveedores, Stock, Reportes #}
                        {% if request.user.role == 'gerente' %}
                            <li class="nav-item"><a class="nav-link" href="{% url 'product_list' %}">Productos</a></li>
                            <li class="nav-item"><a class="nav-link" href="{% url 'supplier_list' %}">Proveedores</a></li>
                            <li class="nav-item"><a class="nav-link" href="{% url 'inventory' %}">Stock</a></li>
                            <li class="nav-item"><a class="nav-link" href="{% url 'reports' %}">Reportes</a></li>
                        {% endif %}

                        {# Admin Cliente: Control total de su empresa #}
                        {% if request.user.role == 'admin_cliente' %}
                            <li class="nav-item"><a class="nav-link" href="{% url 'product_list' %}">Productos</a></li>
                            <li class="nav-item"><a class="nav-link" href="{% url 'supplier_list' %}">Proveedores</a></li>
                            <li class="nav-item"><a class="nav-link" href="{% url 'branch_list' %}">Sucursales</a></li>
                            <li class="nav-item"><a class="nav-link" href="{% url 'inventory' %}">Stock</a></li>
                            <li class="nav-item"><a class="nav-link" href="{% url 'sales_list' %}">Ventas</a></li>
                            <li class="nav-item"><a class="nav-link" href="{% url 'subscription' %}">Suscripción</a></li>
                            <li class="nav-item"><a class="nav-link" href="{% url 'reports' %}">Reportes</a></li>
                            <li class="nav-item"><a class="nav-link" href="{% url 'user_list' %}">Usuarios</a></li>
                        {% endif %}

                        {# Super Admin: Solo gestión de clientes/tenants y facturación (TemucoSoft) #}
                        {% if request.user.role == 'super_admin' %}
                        {% endif %}

                        {# Cliente Final: Tienda Online #}
                        {% if request.user.role == 'cliente_final' %}
                            <li class="nav-item"><a class="nav-link" href="{% url 'product_list' %}">Catálogo</a></li>
                            <li class="nav-item"><a class="nav-link" href="{% url 'cart' %}">Carrito</a></li>
                        {% endif %}

                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                                <strong>{{ request.user.username }}</strong>
                                {% if request.user.role == 'super_admin' %}
                                    <span class="badge bg-danger ms-2">Admin Sistema</span>
                                {% elif request.user.role == 'admin_cliente' %}
                                    <span class="badge bg-warning ms-2">Admin Empresa</span>
                                {% elif request.user.role == 'gerente' %}
                                    <span class="badge bg-info ms-2">Gerente</span>
                                {% elif request.user.role == 'vendedor' %}
                                    <span class="badge bg-success ms-2">Vendedor</span>
                                {% elif request.user.role == 'cliente_final' %}
                                    <span class="badge bg-secondary ms-2">Cliente</span>
                                {% endif %}
                            </a>
                            <ul class="dropdown-menu">
                                {% if request.user.company %}
                                    <li><span class="dropdown-item-text">Empresa: <strong>{{ request.user.company }}</strong></span></li>
                                    <li><hr class="dropdown-divider"></li>
                                {% endif %}
                                <li><a class="dropdown-item" href="{% url 'logout' %}">Cerrar Sesión</a></li>
                            </ul>
                        </li>
                    {% else %}
                        <li class="nav-item"><a class="nav-link" href="{% url 'login' %}">Iniciar Sesión</a></li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}

        {% block content %}
        {% endblock %}
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>